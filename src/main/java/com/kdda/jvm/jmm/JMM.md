## JMM （Java memory Model）
JVM （Java Virtual Machine）的内存模型JMM规定了多线程情况下共享变量的可见性和有序性，确保不同线程之间的变量读取和写入操作的一致性。JMM的主要部分包括：
### 1. 内存区域
JVM的内存结构可以分为多个区域，各区域的功能和作用如下：
- 堆（Heap）：用于存储所有的对象和数组，所有线程共享，分为新生代和老年代。垃圾回收器管理的主要区域，。
- 栈（Stack）：每个线程有独立的虚拟机栈，存储局部变量表、操作数栈、方法返回地址等。
  1. 每个线程都有自己独立的栈，有多少个线程就有多少个栈；
  2. 线程栈的大小可以通过JVM启动参数-Xss<size>来设置如-Xss512k、-Xss1m
     1. 栈大小影响: 设置过小的栈大小可能导致 StackOverflowError，特别是在递归调用时；而设置过大的栈大小可能导致可用内存减少，从而影响其他线程的创建。
     2. 默认值: 不同的JVM实现和操作系统可能有不同的默认栈大小。一般情况下，默认大小通常在256KB到1MB之间。
     3. 多线程的影响: 在创建大量线程时，过大的栈大小会消耗大量内存，因此要根据应用的需求合理设置。
     4. 如果需要查看当前Java进程的线程栈大小，可以使用Java的管理工具（如 JVisualVM）或通过程序代码动态查询。
  3. 每当一个线程调用一个方法的时，JVM会为该方法创建一个栈桢（stack frame），包含该方法的局部变量、参数、返回地址和操作数等信息；
  4. 这个栈帧会被压入该线程的栈中，栈遵循“后进先出”（Last In, First Out, LIFO）的原则，最近调用的方法先被弹出。
  5. 当方法执行完毕，栈帧会从栈中弹出，释放相应的内存。
- 程序计数器（Program Counter, PC）：保存每个线程当前执行的字节码行号。
- 本地方法栈（Native Method）：为本地方法服务，如JNI（Java Native Interface）调用，与操作系统有关。
- 方法区（Method Area）；存储类元数据、常量池、静态变量等。也是线程共享的区域，通常也叫“永久代”（JDK8之前）或“元空间”（JDK8之后）。
